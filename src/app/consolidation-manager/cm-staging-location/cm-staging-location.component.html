<mat-card class="mat-elevation-z g-card mt-2 mb-3" data-automation-id="staging-location-card">
    <div class="mb-3">
        <app-icon-heading-component heading="Staging Locations" icon="add_location_alt" [automationId]="'staging-location-heading'">
        </app-icon-heading-component>
    </div>
    <div class="card bg-light-blue bg-50 br-none px-4 py-4 br-14 mb-3" data-automation-id="search-section">
        <app-SLSearchOrderNumberTote
            [orderNumberTote]="this.orderNumberTote"
            (clearAllEvent)="clearAll()"
            (stagingOrderNumEvent)="orderNumberTote = $event.ordTote; stagingLocsOrderNum($event.event)"
            data-automation-id="search-order-tote-component"
        ></app-SLSearchOrderNumberTote>
    </div>
    <div class="card br-14 p-4" data-automation-id="staging-location-content">
        <div class="row align-items-center" data-automation-id="search-and-actions-row">
            <div class="col-xl-4">
                <div class="d-flex g-mini-search-box w-100 mb-3" data-automation-id="search-box-container">
                    <mat-form-field class="w-100 bg-white br-8" appearance="fill" data-automation-id="staging-location-search-field">
                        <span class="material-symbols-outlined icon-search" data-automation-id="search-icon">
                            Search
                        </span>
                        <input type="text" placeholder="Search" aria-label="Search" (input)="searchToteAndLocation()" matInput  [(ngModel)]="stagingLocation" data-automation-id="staging-location-search-input">
                        <button matSuffix *ngIf="stagingLocation" class="clear-btn"  (click)="stagingLocation= '';searchToteAndLocation()" data-automation-id="clear-search-button"><mat-icon class="text-20 text-chrome-600">cancel</mat-icon></button>
                        <mat-autocomplete data-automation-id="search-autocomplete">
                            <mat-option data-automation-id="search-option">
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
            </div>
            <div class="col">
                <div class="d-flex d-xl-block gap-12 justify-content-end mb-3">
                    <button mat-stroked-button color="warn" class=" float-end btn-regular px-4 button-remove-all-w-stroke btn-flex-1" (click)="unstageAll()" data-automation-id="unstage-all-button">
                        Unstage All
                    </button>
                </div>
            </div>
        </div>
        <div class="card br-14 table-responsive borderless" data-automation-id="staging-table-container">
            <ng-scrollbar class="mat-table-scrollbar staging-location-table-height" track="all" data-automation-id="staging-table-scrollbar">

                <table class="w-100 table-borderless" mat-table [dataSource]="stageTables" matSort data-automation-id="staging-table">
                    <ng-container matColumnDef="select" >
                        <th mat-header-cell *matHeaderCellDef data-automation-id="table-header-tote-id"> Tote ID </th>
                        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-row-' + i + '-' + element.toteID + '-tote-id-cell'">
                            <mat-form-field class="mt-2 custom-form-field w-100" appearance="outline" [attr.data-automation-id]="'tote-id-field-' + i + '-' + element.toteID">
                                <input matInput type="text" readonly="true" disabled class="text-chrome-900"
                                    [(ngModel)]="element.toteID" [attr.data-automation-id]="'tote-id-input-' + i + '-' + element.toteID">
                            </mat-form-field>
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef data-automation-id="table-header-staging-location"> Staging Location </th>
                        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-row-' + i + '-' + element.toteID + '-staging-location-cell'">
                            <mat-form-field class="mt-2 custom-form-field w-100" appearance="outline" [attr.data-automation-id]="'staging-location-field-' + i + '-' + element.toteID">
                                <input matInput type="text" 
                                [matTooltip]="'Current Loc: '+ (element.stagingLocation ? element.stagingLocation :element.stagingLocationOld ? element.stagingLocationOld : '') " matTooltipPosition="above" matTooltipTrigger="focus"
                                (focus)="element.stagingLocationOld = element.stagingLocation;element.stagingLocation = ''"
                                (blur)="element.stagingLocation = element.stagingLocationOld"
                                (keypress)="saveToteStagingLocation($event,element.toteID,element.stagingLocation,i,0)"  
                                    [(ngModel)]="element.stagingLocation" [attr.data-automation-id]="'staging-location-input-' + i + '-' + element.toteID">
                            </mat-form-field>
                        </td>
                    </ng-container>

                    <!-- Action Column -->
                    <ng-container matColumnDef="action" stickyEnd>

                        <th width="8%" class="text-center px-2" mat-header-cell *matHeaderCellDef data-automation-id="table-header-action">Action
                        </th>
                        <td class="pe-0" mat-cell *matCellDef="let element ; let i = index" width="8%" [attr.data-automation-id]="'table-row-' + i + '-' + element.toteID + '-action-cell'">
                            <button class="mt-2 mx-auto xsm-icon-button" mat-flat-button aria-label="Delete"
                                matTooltip="Remove" matTooltipPosition="left" color="warn" (click)="saveToteStagingLocation('click',element.toteID,'',i,1)" [attr.data-automation-id]="'remove-button-' + i + '-' + element.toteID">
                                <mat-icon>close</mat-icon>
                            </button>
                        </td>

                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" class="table-header-clr" data-automation-id="staging-table-header-row"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" [attr.data-automation-id]="'staging-table-row-' + row.toteID"></tr>
                </table>
            </ng-scrollbar>
        </div>
        
    </div>
</mat-card>