<div class="d-flex justify-content-between mb-4 align-items-center">
    <div class="w-48px"></div>
    <h1 class="m-0" mat-dialog-title data-automation-id="reel-transactions-heading">Reel Transactions</h1>
    <button mat-icon-button class="close-button dialog-close-button-fix" [mat-dialog-close]="false" data-automation-id="close-button">
        <mat-icon class="close-icon">close</mat-icon>
    </button>
</div>
<mat-dialog-content>
    <div class="card p-3">
        <div class="row mb-2">
            <div class="col-xl-4 ">
                <mat-form-field class="custom-form-field __grab_cursor w-100" appearance="outline" data-automation-id="item-number-field">
                    <mat-label data-automation-id="item-number-label">{{fieldNames.itemNumber}}</mat-label>
                    <input matInput disabled [(ngModel)]="itemNumber" data-automation-id="item-number-input">
                </mat-form-field>
            </div>
            <div class="col-xl-8 ">
                <mat-form-field class="custom-form-field __grab_cursor w-100" appearance="outline" data-automation-id="description-field">
                    <mat-label data-automation-id="description-label">Description</mat-label>
                    <input matInput disabled [(ngModel)]="description" data-automation-id="description-input">
                </mat-form-field>
            </div>
        </div>
        <div class="row mb-2">
            <div class="col-xl-6 ">
                <mat-form-field class="custom-form-field __grab_cursor w-100" appearance="outline" data-automation-id="parts-inducted-field">
                    <mat-label data-automation-id="parts-inducted-label">Total Parts To Be Inducted</mat-label>
                    <input #fieldFocus  matInput type="number" [(ngModel)]="partsInducted"  min=0 oninput="validity.valid||(value='');" (change)="updateRemaining()" data-automation-id="parts-inducted-input">
                </mat-form-field>
            </div>
            <div class="col-xl-6 ">
                <mat-form-field class="custom-form-field __grab_cursor w-100" appearance="outline" data-automation-id="parts-not-assigned-field">
                    <mat-label data-automation-id="parts-not-assigned-label">Number Of Parts Not Assigned </mat-label>
                    <input matInput type="number" disabled [(ngModel)]="partsNotAssigned" data-automation-id="parts-not-assigned-input">
                </mat-form-field>
            </div>
        </div>
        <div class="row mb-2">
            <div class="col-xl-6 ">
                <mat-form-field class="custom-form-field __grab_cursor w-100" appearance="outline" data-automation-id="reels-inducted-field">
                    <mat-label data-automation-id="reels-inducted-label">Number Of Reels To Be Inducted</mat-label>
                    <input matInput [(ngModel)]="noOfReels" min=0 oninput="validity.valid||(value='');"  type="number" #noOfReeltemp  (keyup)="initiateReelGenrator($event)"  (keyup)="limitNoOfReels()" data-automation-id="reels-inducted-input">
                </mat-form-field>
            </div>
            <div class="col-xl-6 mt-1">
                <button mat-flat-button color="primary" class="btn-regular w-100" (click)="OpenReelSerial()" data-automation-id="auto-generate-button">
                    Auto Generate Reels & Serial Number
                </button>
            </div>
        </div>
    </div>

<div *ngIf="autoGenerateReel">
    <div class="card br-14 table-responsive borderless px-0 my-3" data-automation-id="reel-table-container">
        <ng-scrollbar track="all" class="mat-table-scrollbar  scrollbar-hover-padding h-350" data-automation-id="reel-table-scrollbar">

            <table mat-table [dataSource]="generateReelAndSerial"
                class="w-100" data-automation-id="reel-table">

                <ng-container matColumnDef="reel_serial_number">
                    <th mat-header-cell *matHeaderCellDef data-automation-id="table-header-reel-serial-number"> Reel Serial No.
                    </th>
                    <td mat-cell *matCellDef="let element;let i=index" [attr.data-automation-id]="'table-row-' + i + '-reel-serial-number-cell'">
                        <mat-form-field class="custom-form-field w-100 pe-2 "   appearance="outline" [attr.data-automation-id]="'reel-serial-field-' + i">
                            <input   (input)="changeVal($event,i)" matInput type='text' value="{{element.reel_serial_number}}"  [(ngModel)]="element.reel_serial_number"
                            #serialTemp
                            name="reel_serial_number"
                            required [attr.data-automation-id]="'reel-serial-input-' + i">
                    </mat-form-field>
                    </td>

                </ng-container>

                <ng-container matColumnDef="button">
                    <th mat-header-cell *matHeaderCellDef data-automation-id="table-header-button"></th>
                    <td mat-cell *matCellDef="let element ;let i =index" [attr.data-automation-id]="'table-row-' + i + '-button-cell'">
                        <div>
                            <button mat-stroked-button class="btn-regular me-3" color="primary" (click)="GenerateSerialNumber(i)" [attr.data-automation-id]="'next-serial-button-' + i">Next Serial Number
                            </button>
                        </div>
                    </td>
                </ng-container>

                <ng-container matColumnDef="reel_part_quantity">
                    <th mat-header-cell *matHeaderCellDef data-automation-id="table-header-reel-part-quantity"> Reel Part Quantity
                    </th>
                    <td mat-cell *matCellDef="let element;let i =index" [attr.data-automation-id]="'table-row-' + i + '-reel-part-quantity-cell'">
                        <mat-form-field class="custom-form-field w-100 pe-2" appearance="outline" [attr.data-automation-id]="'reel-part-quantity-field-' + i">
                            <input matInput type="number" value="{{element.reel_part_quantity}}" min=0 oninput="validity.valid||(value='');" (keyup)="onChange($event,i)" [attr.data-automation-id]="'reel-part-quantity-input-' + i">
    </mat-form-field>
                    </td>
                </ng-container>

                <ng-container matColumnDef="action" stickyEnd>
                    <th width="10%"  mat-header-cell *matHeaderCellDef class="ps-2" data-automation-id="table-header-actions"> Actions </th>
                    <td mat-cell *matCellDef="let element ;let i =index " class="ps-2" [attr.data-automation-id]="'table-row-' + i + '-actions-cell'">
                    <div class="d-flex gap-12 align-items-center">
                            <button mat-flat-button color="primary" class="xsm-icon-button" (click)="OpenDetails(i,element)" [attr.data-automation-id]="'edit-button-' + i">
                                <mat-icon class="material-symbols-outlined" [attr.data-automation-id]="'edit-icon-' + i">border_color</mat-icon>
                            </button>
                            <button mat-flat-button color="primary" class="xsm-icon-button" (click)="print(i,element)" [attr.data-automation-id]="'print-button-' + i">
                                <mat-icon class="material-symbols-outlined" [attr.data-automation-id]="'print-icon-' + i">print</mat-icon>
                            </button>

                        </div>
                    </td>
                </ng-container>

                <tr class="mat-row" *matNoDataRow data-automation-id="table-no-data-row">
                    <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                        No data available in table.
                    </td>
                </tr>

                <tr mat-header-row *matHeaderRowDef="displayedColumns" data-automation-id="reel-table-header-row"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns; index as i" [attr.data-automation-id]="'table-row-' + i"></tr>

            </table>
        </ng-scrollbar>
    </div>
</div>

    <button mat-flat-button color="primary" class="btn-lg w-100 mt-2" (click)="reeloverviewsubmit()" data-automation-id="submit-button">Submit</button>
</mat-dialog-content>