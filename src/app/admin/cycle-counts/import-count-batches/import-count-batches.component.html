<div class="d-flex justify-content-between align-items-center mb-3">
  <div class="w-98px"></div>
  <h1 class="m-0 text-center" mat-dialog-title data-automation-id="heading-import-count-batches">Import Count Batches</h1>
  <button
    mat-icon-button
    class="close-button dialog-close-button-fix"
    (click)="close()"
    data-automation-id="close-dialog-button"
  >
    <mat-icon class="close-icon">close</mat-icon>
  </button>
</div>
<div class="container-fluid">
<div class="row header-filter-bar px-2 mb-3">
  <div class="col-xl-3">
    <mat-form-field class="action-dropdown w-100" appearance="outline" data-automation-id="form-field-import-type">
      <mat-label data-automation-id="label-import-type">Import Type</mat-label>
      <mat-select [(value)]="selectedImportType" placeholder="Import Type" (selectionChange)="onImportTypeChange()" [attr.data-automation-id]="'select-import-type-' + (selectedImportType || '')">
        <mat-option *ngFor="let type of importTypes; let i = index" [value]="type" [attr.data-automation-id]="'option-import-type-'  + type">{{ type }}</mat-option>
      </mat-select>
      <span class="material-symbols-outlined icon-expand-more">expand_more</span>
    </mat-form-field>
  </div>
  <div class="col-xl-3">
    <!-- Filter By Dropdown -->
    <mat-form-field class="action-dropdown w-100" appearance="outline" data-automation-id="form-field-filter-by">
      <mat-label data-automation-id="label-filter-by">Filter By</mat-label>
      <mat-select [(value)]="selectedFilterBy" [disabled]="!selectedImportType" [attr.data-automation-id]="'select-filter-by-' + (selectedFilterBy || '')">
        <mat-option (click)="onFilterByChange(fileInput)" value="Spreadsheet" data-automation-id="option-filter-by-spreadsheet">Spreadsheet</mat-option>
        <mat-option (click)="onFilterByChange(fileInput)" data-automation-id="option-filter-by-location">{{dependVal}}</mat-option>
      </mat-select>
      <span class="material-symbols-outlined icon-expand-more">expand_more</span>
    </mat-form-field>
  </div>
  <div class="col-xl-3">
    <div
    class="d-flex align-items-center gap-2"
    *ngIf="selectedFilterBy === 'Spreadsheet' && uploadedFileName"
  >
    <span class="uploaded-file" data-automation-id="uploaded-file-name">{{ uploadedFileName }}</span>
    <button mat-stroked-button color="warn" class="button-remove-all-w-stroke bg-white" (click)="removeFile()" data-automation-id="delete-file-button">
      Delete
    </button>
    <button mat-flat-button color="primary" class="form-button-submit" (click)="confirmImport()" data-automation-id="confirm-import-button">
      Confirm
    </button>
  </div>
  <!-- Hidden File Input -->
  <input
    type="file"
    #fileInput
    accept=".xls,.xlsx"
    hidden
    (change)="onFileSelect($event)" 
    [attr.data-automation-id]="'input-file-' + fileInput.value"
    >
  </div>
  <div class="mt-3" [formGroup]="filtersForm" [hidden]="selectedImportType !== 'Location'">
    <mat-checkbox
      (change)="setLocationCheck($event,'empty')"
      formControlName="includeEmpty"
      class="example-margin custom-checkbox mb-2 me-3"
      color="primary"
      data-automation-id="checkbox-include-empty-locations">
      Include Empty Locations?
    </mat-checkbox>
    <mat-checkbox
      (change)="setLocationCheck($event,'other')"
      formControlName="includeOther"
      class="example-margin custom-checkbox mb-2"
      color="primary"
      data-automation-id="checkbox-include-other-locations">
      Include Other Locations?
    </mat-checkbox>
  </div>
</div>
</div>
<div>
<div class="card br-14 table-responsive borderless cardBorder mb-3">
  <ng-scrollbar track="all" class="mat-table-scrollbar h-50v">
    <table class="w-100 table-borderless" mat-table [dataSource]="dataSource" matSort>
      <!-- Item Number -->
      <ng-container matColumnDef="itemNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Item Number"> {{ItemNumber}} </th>
        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-data-Item Number-' + element.itemNumber" [matTooltip]="element.itemNumber"   matTooltipPosition="above" [matTooltipDisabled]="element.itemNumber && element.itemNumber.length>=12?false:true"> {{element.itemNumber}} </td>
      </ng-container>
  <!-- Description -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Description"> Description </th>
        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-data-Description-' + element.description" [matTooltip]="element.description"   matTooltipPosition="above" [matTooltipDisabled]="element.description && element.description.length>=15?false:true"> {{element.description}} </td>
      </ng-container>
      <!-- Location Quantity -->
      <ng-container matColumnDef="locationQuantity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Location Qty">Location Qty</th>
        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-data-Location Qty-' + element.locationQuantity" [matTooltip]="element.locationQuantity"   matTooltipPosition="above" [matTooltipDisabled]="element.locationQuantity && element.locationQuantity.length>=15?false:true">
          {{ element.locationQuantity }}
        </td>
      </ng-container>
      <!-- UM -->
      <ng-container matColumnDef="um">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-UM"> {{UnitOfMeasure}} </th>
        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-data-UM-' + element.um" [matTooltip]="element.um"   matTooltipPosition="above" [matTooltipDisabled]="element.um && element.um.length>=15?false:true">
          {{ element.um }}
        </td>
      </ng-container>
      <!-- Warehouse -->
      <ng-container matColumnDef="warehouse">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Warehouse">Warehouse</th>
        <td mat-cell *matCellDef="let element; let i = index" [attr.data-automation-id]="'table-data-Warehouse-' + element.warehouse" [matTooltip]="element.warehouse"   matTooltipPosition="above" [matTooltipDisabled]="element.warehouse && element.warehouse.length>=15?false:true">
          {{ element.warehouse }}
        </td>
      </ng-container>
      <!-- Locations -->
      <ng-container matColumnDef="locations">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Location">Location</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Location-' + element.locations" [matTooltip]="element.locations"   matTooltipPosition="above" [matTooltipDisabled]="element.locations && element.locations.length>=12?false:true" >
          {{ element.locations }}
        </td>
      </ng-container>
      <!-- Velocity Code -->
      <ng-container matColumnDef="velocityCode">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Velocity Code">Velocity Code</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Velocity Code-' + element.velocityCode" [matTooltip]="element.velocityCode"   matTooltipPosition="above" [matTooltipDisabled]="element.velocityCode && element.velocityCode.length>=12?false:true" >
          {{ element.velocityCode }}
        </td>
      </ng-container>
      <!-- Cell Size -->
      <ng-container matColumnDef="cellSize">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Cell Size">Cell Size</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Cell Size-' + element.cellSize" [matTooltip]="element.cellSize"   matTooltipPosition="above" [matTooltipDisabled]="element.cellSize && element.cellSize.length>=12?false:true" >
          {{ element.cellSize }}
        </td>
      </ng-container>
      <!-- Serial Number -->
      <ng-container matColumnDef="serialNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Serial No.">Serial No.</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Serial No.-' + element.serialNumber" [matTooltip]="element.serialNumber"   matTooltipPosition="above" [matTooltipDisabled]="element.serialNumber && element.serialNumber.length>=12?false:true" >
          {{ element.serialNumber }}
        </td>
      </ng-container>
      <!-- Lot Number -->
      <ng-container matColumnDef="lotNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Lot No.">Lot No.</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Lot No.-' + element.lotNumber" [matTooltip]="element.lotNumber"   matTooltipPosition="above" [matTooltipDisabled]="element.lotNumber && element.lotNumber.length>=12?false:true" >
          {{ element.lotNumber }}
        </td>
      </ng-container>
      <!-- Expiration Date -->
      <ng-container matColumnDef="expirationDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header data-automation-id="table-header-Exp Date">Exp Date</th>
        <td mat-cell *matCellDef="let element; let i = index" class="table-cell" [attr.data-automation-id]="'table-data-Exp Date-' + element.expirationDate" [matTooltip]="element.expirationDate"   matTooltipPosition="above" [matTooltipDisabled]="element.expirationDate && element.expirationDate.length>=12?false:true" >
          {{ element.expirationDate }}
        </td>
      </ng-container>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell " [attr.colspan]="displayedColumns.length">
          No data available in table.
        </td>
    </tr>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </ng-scrollbar>
</div>
<div class="d-flex justify-content-between bg-white mb-3">
  <div class="table-pagination d-flex justify-content-start" data-automation-id="paginator-import-count-batches">
      <mat-paginator [length]="this.customPagination.total" showFirstLastButtons [pageSize]="10"
          [pageSizeOptions]="[10, 20, 100]" (page)="handlePageEvent($event)" data-automation-id="paginator"></mat-paginator>
  </div>
</div>
</div>
<div class="d-flex justify-content-end gap-3 mt-9">
  <button
    mat-flat-button
    class="form-button-submit btn-lg w-100"
    color="primary"
    (click)="importToQueue()"
    data-automation-id="import-to-queue-button"
  >
    Import to Queue
  </button>
</div>



